(function(c){function I(a,b,e){var d=this;return this.on("click.pjax",a,function(a){var f=c.extend({},l(b,e));f.container||(f.container=c(this).attr("data-pjax")||d);y(a,f)})}function y(a,b,e){e=l(b,e);b=a.currentTarget;if("A"!==b.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(1<a.which||a.metaKey||a.ctrlKey||a.shiftKey||a.altKey||location.protocol!==b.protocol||location.hostname!==b.hostname||-1<b.href.indexOf("#")&&b.href.replace(/#.*/,"")==location.href.replace(/#.*/,"")||a.isDefaultPrevented())){var d={url:b.href,container:c(b).attr("data-pjax"),target:b};e=c.extend({},d,e);d=c.Event("pjax:click");c(b).trigger(d,[e]);d.isDefaultPrevented()||(h(e),a.preventDefault(),c(b).trigger("pjax:clicked",[e]))}}function J(a,b,e){e=l(b,e);b=a.currentTarget;var d=c(b);if("FORM"!==b.tagName.toUpperCase())throw"$.pjax.submit requires a form element";d={type:(d.attr("method")||"GET").toUpperCase(),url:d.attr("action"),container:d.attr("data-pjax"),target:b};if("GET"!==d.type&&void 0!==window.FormData)d.data=new FormData(b),d.processData=!1,d.contentType=!1;else{if(c(b).find(":file").length)return;d.data=c(b).serializeArray()}h(c.extend({},d,e));a.preventDefault()}function h(a){function b(a,b,d){d||(d={});d.relatedTarget=e;a=c.Event(a,d);g.trigger(a,b);return!a.isDefaultPrevented()}a=c.extend(!0,{},c.ajaxSettings,h.defaults,a);c.isFunction(a.url)&&(a.url=a.url());var e=a.target,d=q(a.url).hash,g=a.context=A(a.container);a.data||(a.data={});c.isArray(a.data)?a.data.push({name:"_pjax",value:g.selector}):a.data._pjax=g.selector;var f;a.beforeSend=function(c,e){"GET"!==e.type&&(e.timeout=0);c.setRequestHeader("X-PJAX","true");c.setRequestHeader("X-PJAX-Container",g.selector);if(!b("pjax:beforeSend",[c,e]))return!1;0<e.timeout&&(f=setTimeout(function(){b("pjax:timeout",[c,a])&&c.abort("timeout")},e.timeout),e.timeout=0);e=q(e.url);d&&(e.hash=d);a.requestUrl=B(e)};a.complete=function(c,d){f&&clearTimeout(f);b("pjax:complete",[c,d,a]);b("pjax:end",[c,a])};a.error=function(c,d,e){var f=C("",c,a);c=b("pjax:error",[c,d,e,a]);"GET"==a.type&&"abort"!==d&&c&&r(f.url)};a.success=function(e,f,m){var n=h.state,p="function"===typeof c.pjax.defaults.version?c.pjax.defaults.version():c.pjax.defaults.version,l=m.getResponseHeader("X-PJAX-Version"),k=C(e,m,a),z=q(k.url);d&&(z.hash=d,k.url=z.href);if(p&&l&&p!==l)r(k.url);else if(k.contents){h.state={id:a.id||(new Date).getTime(),url:k.url,title:k.title,container:g.selector,fragment:a.fragment,timeout:a.timeout};(a.push||a.replace)&&window.history.replaceState(h.state,k.title,k.url);if(c.contains(a.container,document.activeElement))try{document.activeElement.blur()}catch(Q){}k.title&&(document.title=k.title);b("pjax:beforeReplace",[k,a],{state:h.state,previousState:n});g.html(k.contents);"undefined"!=typeof pcInit&&pcInit();(n=g.find("input[autofocus], textarea[autofocus]").last()[0])&&document.activeElement!==n&&n.focus();K(k.scripts);k=a.scrollTo;d&&(n=decodeURIComponent(d.slice(1)),n=document.getElementById(n)||document.getElementsByName(n)[0])&&(k=c(n).offset().top);"number"==typeof k&&c(window).scrollTop(k);b("pjax:success",[e,f,m,a])}else r(k.url)};h.state||(h.state={id:(new Date).getTime(),url:window.location.href,title:document.title,container:g.selector,fragment:a.fragment,timeout:a.timeout},window.history.replaceState(h.state,document.title));D(h.xhr);h.options=a;var m=h.xhr=c.ajax(a);0<m.readyState&&(a.push&&!a.replace&&(L(h.state.id,E(g)),window.history.pushState(null,"",a.requestUrl)),b("pjax:start",[m,a]),b("pjax:send",[m,a]));return h.xhr}function M(a,b){return h(c.extend({url:window.location.href,push:!1,replace:!0,scrollTo:!1},l(a,b)))}function r(a){window.history.replaceState(null,"",h.state.url);window.location.replace(a)}function F(a){t||D(h.xhr);var b=h.state,e=a.state,d;if(e&&e.container){if(t&&N==e.url)return;if(b){if(b.id===e.id)return;d=b.id<e.id?"forward":"back"}var g=p[e.id]||[];a=c(g[0]||e.container);g=g[1];if(a.length){if(b){var f=d,m=b.id,l=E(a);p[m]=l;"forward"===f?(f=u,l=v):(f=v,l=u);f.push(m);(m=l.pop())&&delete p[m];w(f,h.defaults.maxCacheLength)}d=c.Event("pjax:popstate",{state:e,direction:d});a.trigger(d);d={id:e.id,url:e.url,container:a,push:!1,fragment:e.fragment,timeout:e.timeout,scrollTo:!1};g?(a.trigger("pjax:start",[null,d]),h.state=e,e.title&&(document.title=e.title),b=c.Event("pjax:beforeReplace",{state:e,previousState:b}),a.trigger(b,[g,d]),a.html(g),a.trigger("pjax:end",[null,d])):h(d);a[0].offsetHeight}else r(location.href)}t=!1}function O(a){var b=c.isFunction(a.url)?a.url():a.url,e=a.type?a.type.toUpperCase():"GET",d=c("<form>",{method:"GET"===e?"GET":"POST",action:b,style:"display:none"});"GET"!==e&&"POST"!==e&&d.append(c("<input>",{type:"hidden",name:"_method",value:e.toLowerCase()}));a=a.data;if("string"===typeof a)c.each(a.split("&"),function(a,b){a=b.split("=");d.append(c("<input>",{type:"hidden",name:a[0],value:a[1]}))});else if(c.isArray(a))c.each(a,function(a,b){d.append(c("<input>",{type:"hidden",name:b.name,value:b.value}))});else if("object"===typeof a)for(var g in a)d.append(c("<input>",{type:"hidden",name:g,value:a[g]}));c(document.body).append(d);d.submit()}function D(a){a&&4>a.readyState&&(a.onreadystatechange=c.noop,a.abort())}function E(a){var b=a.clone();b.find("script").each(function(){this.src||jQuery._data(this,"globalEval",!1)});return[a.selector,b.contents()]}function B(a){a.search=a.search.replace(/([?&])(_pjax|_)=[^&]*/g,"");return a.href.replace(/\?($|#)/,"$1")}function q(a){var b=document.createElement("a");b.href=a;return b}function l(a,b){a&&b?b.container=a:b=c.isPlainObject(a)?a:{container:a};b.container&&(b.container=A(b.container));return b}function A(a){a=c(a);if(a.length){if(""!==a.selector&&a.context===document)return a;if(a.attr("id"))return c("#"+a.attr("id"));throw"cant get selector for pjax container!";}throw"no pjax container for "+a.selector;}function C(a,b,e){var d={},g=/<html/i.test(a);b=b.getResponseHeader("X-PJAX-URL");d.url=b?B(q(b)):e.requestUrl;b=a;g&&(b=a.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]);var f=b.match(/<title[^>]*>([\s\S.]*)<\/title>/i);f&&(b=b.replace(f[0],""),d.title=c.trim(f[1]));if(f=b.match(/<module>([\s\S.]*)<\/module>/i))b=b.replace(f[0],""),d.module=c.trim(f[1]);if(f=b.match(/<controller>([\s\S.]*)<\/controller>/i))b=b.replace(f[0],""),d.controller=c.trim(f[1]);if(f=b.match(/<addon>([\s\S.]*)<\/addon>/i))b=b.replace(f[0],""),d.addon=c.trim(f[1]);b=c(c.parseHTML(b,document,!0));if(0===b.length)return d;e.fragment?("body"===e.fragment?a=b:(a=e.fragment,a=b.filter(a).add(b.find(a)).first()),a.length&&(d.contents="body"===e.fragment?a:a.contents(),d.title||(d.title=a.attr("title")||a.data("title")))):g?g&&(d.contents=c(c.parseHTML(a,document,!0))):d.contents=b;return d}function K(a){if(a){var b=c("script[src]");a.each(function(){var a=this.src;if(!b.filter(function(){return this.src===a}).length){var d=document.createElement("script"),g=c(this).attr("type");g&&(d.type=g);d.src=c(this).attr("src");document.head.appendChild(d)}})}}function L(a,b){p[a]=b;u.push(a);w(v,0);w(u,h.defaults.maxCacheLength)}function w(a,b){for(;a.length>b;)delete p[a.shift()]}function P(){return c("meta").filter(function(){var a=c(this).attr("http-equiv");return a&&"X-PJAX-VERSION"===a.toUpperCase()}).attr("content")}function G(){c.fn.pjax=I;c.pjax=h;c.pjax.enable=c.noop;c.pjax.disable=H;c.pjax.click=y;c.pjax.submit=J;c.pjax.reload=M;c.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:P};c(window).on("popstate.pjax",F)}function H(){c.fn.pjax=function(){return this};c.pjax=O;c.pjax.enable=G;c.pjax.disable=c.noop;c.pjax.click=c.noop;c.pjax.submit=c.noop;c.pjax.reload=function(){window.location.reload()};c(window).off("popstate.pjax",F)}var t=!0,N=window.location.href,x=window.history.state;x&&x.container&&(h.state=x);"state"in window.history&&(t=!1);var p={},v=[],u=[];0>c.inArray("state",c.event.props)&&c.event.props.push("state");c.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/);c.support.pjax?G():H()})(jQuery);