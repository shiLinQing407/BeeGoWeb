<script type="text/javascript" src="/static/lib/easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="/static/lib/easyui/locale/easyui-lang-zh_CN.js"></script>
<link rel="stylesheet" href="/static/lib/easyui/themes/custom/easyui.css">
<link rel="stylesheet" href="/static/lib/web-icons/index.css">

<div class="right-main">
    <div id="js_main_header" class="ui-form main_header">
        <div class="layui-row">
            <form class="layui-form layui-col-md12 ok-search">
                <input class="layui-input" placeholder="开始日期" autocomplete="off" id="startTime">
                <input class="layui-input" placeholder="截止日期" autocomplete="off" id="endTime">
                <input class="layui-input" placeholder="请输入标题" autocomplete="off">
                <button class="layui-btn" lay-submit="" lay-filter="search">
                    <i class="layui-icon layui-icon-search"></i>
                </button>
            </form>
        </div>
        <okToolbar>
            <button class="layui-btn" id="js_addBtn">
                <i class="layui-icon">&#xe61f;</i>添加文章
            </button>
        </okToolbar>

    </div>

    <table id="grid-table">
        <thead>
        <tr>
            <th data-options="field:'title',width:300,align:'center',sortable: true">标题</th>
            <th data-options="field:'class_name',width:80,align:'center',sortable: true">分类</th>
            <th data-options="field:'tags',width:200,align:'center',sortable: true">标签</th>
            <th data-options="field:'create_time',width:200,align:'center',sortable: true,formatter:formatTimeStamp">创建时间</th>
            <th data-options="field:'_oper',halign:'center',formatter: formatOper">操作</th>
        </tr>
        </thead>
    </table>
</div>

<script type="text/javascript">
    function formatOper(value, row, index) {
        var html = '<span class="grid-operation">';
        html += '<botton class="layui-btn layui-btn-xs layui-btn-warm" onclick="edit(' + row['id'] + ')" title="编辑" lay-event="edit"><i class="layui-icon">&#xe642;</i>编辑</botton>';
        html += '<botton class="layui-btn layui-btn-xs layui-btn-danger" onclick="del(' + row['id'] + ')" title="删除" lay-event="del"><i class="layui-icon">&#xe640;</i>删除</botton>';
        html += '</span>';
        return html;
    }

    function formatTimeStamp(value){
        return $c.formatDateTime(value)
    }

    $(function () {
        $('#grid-table').datagrid({
            url: '{{urlfor "NewsController.LoadList"}}',
            method: "GET",
            height: $c.getGridHeight(),
            rownumbers: true,
            singleSelect: true,
            remoteSort: false,
            multiSort: true,
            emptyMsg: '<span>无相关数据</span>',
            pagination: true,
            pageSize: 10,
            onLoadSuccess:function (data) {
                console.log(data)
            }
        });
        //设置分页控件
        $('#grid-table').datagrid('getPager').pagination({
            pageSize: 10, //每页显示的记录条数，默认为10
            pageList: [10, 20, 30]
        });
    });

    $("#js_addBtn").click(function () {
        if ($(this).hasClass("disabled")) {
            return;
        }
        var url = '';
        $c.openBarWin('添加', 90, 90, url, function () {
            reload();
        });
    });

    $("#js_search").click(function () {
        reload();
    });
    function reload() {
        var keyword = $("#js_keyword").val();
        $('#grid-table').datagrid('reload', {keyword: keyword});
    }
    $("#type").change(function () {
        var keyword = $("#js_keyword").val();
        $('#grid-table').datagrid('reload', {keyword: keyword});
    });
</script>